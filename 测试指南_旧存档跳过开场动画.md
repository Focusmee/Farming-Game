# 旧存档跳过开场动画 - 测试指南

## 📋 测试步骤

### 🎯 测试1：新游戏开场动画
1. **启动游戏**
2. **点击空存档槽**（显示"新游戏还未开始"的存档槽）
3. **验证**：
   - ✅ 应该播放开场动画
   - ✅ 控制台应显示："播放开场动画"
   - ✅ 可以按 **空格键** 或 **ESC键** 跳过动画
   - ✅ 跳过后控制台显示："TimelineManager: 标记玩家已经看过开场动画"

### 🎯 测试2：手动跳过功能
在开场动画播放期间：
1. **按空格键**：应该立即跳过动画进入游戏
2. **按ESC键**：应该立即跳过动画进入游戏
3. **验证**：
   - ✅ 动画立即停止
   - ✅ 直接进入游戏主界面
   - ✅ 控制台显示相关跳过信息

### 🎯 测试3：保存游戏
1. **完成新游戏设置**（跳过或看完开场动画）
2. **进入游戏世界**
3. **按 I 键** 手动保存游戏
4. **验证**：
   - ✅ 控制台显示："DATA[x]SAVED!"
   - ✅ 存档文件已创建

### 🎯 测试4：旧存档加载（核心测试）
1. **重启游戏**或返回主菜单
2. **点击有数据的存档槽**（显示时间和场景的存档槽）
3. **验证**：
   - ✅ **不应该播放开场动画**
   - ✅ 控制台应显示："检测到正在加载存档，跳过开场动画"
   - ✅ 控制台应显示："加载旧存档：自动设置为已观看开场动画状态"
   - ✅ 直接进入游戏世界，从上次保存的位置开始

### 🎯 测试5：多次加载验证
1. **重复加载同一个存档多次**
2. **验证每次加载都跳过开场动画**
3. **保存新的进度，再次加载**
4. **验证**：
   - ✅ 每次都直接进入游戏
   - ✅ 没有开场动画播放

## 🔍 控制台日志检查

### 新游戏时应该看到：
```
播放开场动画
为 TimelineManager 自动添加了 DataGUID 组件
成功注册可保存对象: TimelineManager (GUID: [GUID值])
```

### 跳过动画时应该看到：
```
TimelineManager: 标记玩家已经看过开场动画
```

### 加载旧存档时应该看到：
```
加载存档 [索引]
检测到正在加载存档，跳过开场动画
加载旧存档：自动设置为已观看开场动画状态
加载存档 [索引] 完成
```

### 保存游戏时应该看到：
```
DATA[索引]SAVED!
```

## 🚨 问题排查

### 如果旧存档仍然播放开场动画：

1. **检查控制台日志**：
   - 查看是否显示"检测到正在加载存档，跳过开场动画"
   - 查看是否有任何错误信息

2. **检查SaveSlotUI**：
   - 确认点击的是有数据的存档槽（不是空存档槽）
   - 确认存档槽显示了正确的时间和场景信息

3. **检查TimelineManager组件**：
   - 在Unity编辑器中确认TimelineManager对象有DataGUID组件
   - 确认startDirector字段已正确设置

### 如果跳过按键不工作：

1. **检查输入系统**：
   - 确认Space和Escape键在Input Manager中正确设置
   - 测试其他输入是否正常工作

2. **检查动画状态**：
   - 确认currentDirector不为null
   - 确认动画处于PlayState.Playing状态

## 📊 成功标准

修复成功的标志：
- ✅ 新游戏正常播放开场动画
- ✅ 可以用空格或ESC跳过开场动画
- ✅ 旧存档加载时**完全跳过**开场动画
- ✅ 控制台显示正确的日志信息
- ✅ 游戏功能正常，没有异常

## 🔧 Unity编辑器设置检查

在Unity编辑器中确认：

1. **TimelineManager对象**：
   - 位于PersistentScene中
   - 有DataGUID组件
   - startDirector字段指向正确的PlayableDirector

2. **SaveLoadManager对象**：
   - 正确实现并在场景中存在
   - 没有GUID冲突错误

3. **存档文件**：
   - 位于正确的路径：`%AppData%/LocalLow/[Company]/[Product]/SAVE DATA/`
   - 包含有效的JSON数据

通过以上测试，可以全面验证旧存档跳过开场动画功能是否正常工作。 