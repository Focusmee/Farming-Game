# å†œåœºæ¨¡æ‹Ÿç»è¥æ¸¸æˆ - ç²¾ç®€æ ¸å¿ƒçŽ©æ³•å¾ªçŽ¯å›¾

## æ ¸å¿ƒçŽ©æ³•å¾ªçŽ¯ï¼ˆæœ€ç®€ç‰ˆï¼‰

```mermaid
graph TD
    A[å¼€å§‹æ¸¸æˆ] --> B[èŽ·å¾—åˆå§‹èµ„æº]
    B --> C{é€‰æ‹©è¡ŒåŠ¨}
    
    %% æ ¸å¿ƒå¾ªçŽ¯
    C --> D[ç§æ¤ä½œç‰©]
    C --> E[é‡‡é›†èµ„æº]
    C --> F[ä¸ŽNPCäº¤æ˜“]
    
    D --> G[ç­‰å¾…æ”¶èŽ·]
    E --> H[èŽ·å¾—ç‰©å“]
    F --> H
    G --> H
    
    H --> I{èµ„æºå……è¶³?}
    I -->|å¦| J[å‡ºå”®ç‰©å“]
    I -->|æ˜¯| K[æ‰©å±•ç»è¥]
    
    J --> L[èŽ·å¾—é‡‘å¸]
    L --> C
    K --> M[è§£é”æ–°å†…å®¹]
    M --> C
    
    %% æ ·å¼è®¾ç½®
    style A fill:#e1f5fe
    style C fill:#fff3e0
    style H fill:#4caf50
    style L fill:#ffeb3b
    style M fill:#2196f3
    
    classDef coreAction fill:#81c784,stroke:#388e3c,stroke-width:3px
    classDef decision fill:#ff9800,stroke:#f57c00,stroke-width:2px
    classDef reward fill:#ffc107,stroke:#ff8f00,stroke-width:2px
    
    class D,E,F coreAction
    class C,I decision
    class L,M reward
```

## è¯¦ç»†æ ¸å¿ƒå¾ªçŽ¯ï¼ˆä¸­ç­‰å¤æ‚åº¦ï¼‰

```mermaid
graph LR
    A[ç§æ¤] --> B[æ”¶èŽ·]
    B --> C[å‡ºå”®]
    C --> D[è´­ä¹°ç§å­/å·¥å…·]
    D --> A
    
    B --> E[ä¸ŽNPCäº¤æ˜“]
    E --> F[èŽ·å¾—é‡‘å¸]
    F --> D
    
    C --> G[æ‰©å±•å†œåœº]
    G --> H[æå‡æ•ˆçŽ‡]
    H --> A
    
    style A fill:#4caf50
    style B fill:#8bc34a
    style C fill:#ffeb3b
    style D fill:#2196f3
    style E fill:#9c27b0
    style F fill:#ff9800
    style G fill:#607d8b
    style H fill:#795548
```

## ç³»ç»Ÿäº¤äº’æ ¸å¿ƒå¾ªçŽ¯

```mermaid
graph TD
    A[çŽ©å®¶è¡ŒåŠ¨] --> B[æ—¶é—´æŽ¨è¿›]
    B --> C[ä½œç‰©ç”Ÿé•¿]
    C --> D[NPCè¡Œä¸ºæ›´æ–°]
    D --> E[å¸‚åœºå˜åŒ–]
    E --> F[æ–°çš„æœºä¼š]
    F --> A
    
    style A fill:#2196f3
    style B fill:#ff9800
    style C fill:#4caf50
    style D fill:#9c27b0
    style E fill:#f44336
    style F fill:#ffeb3b
```

## æ ¸å¿ƒçŽ©æ³•è¦ç´ ï¼ˆæœ€ç®€åŒ–ï¼‰

### ðŸŒ± **ç§æ¤å¾ªçŽ¯**
**æ’­ç§** â†’ **ç­‰å¾…** â†’ **æ”¶èŽ·** â†’ **å‡ºå”®** â†’ **å†æŠ•èµ„**

### ðŸ’° **ç»æµŽå¾ªçŽ¯**  
**èŽ·å¾—ç‰©å“** â†’ **å‡ºå”®èŽ·åˆ©** â†’ **è´­ä¹°å‡çº§** â†’ **æå‡æ•ˆçŽ‡**

### ðŸ¤ **ç¤¾äº¤å¾ªçŽ¯**
**ä¸ŽNPCäº¤äº’** â†’ **å®Œæˆäº¤æ˜“** â†’ **è§£é”å†…å®¹** â†’ **èŽ·å¾—ä¼˜åŠ¿**

### â° **æ—¶é—´å¾ªçŽ¯**
**æ—¥å¤œæ›´æ›¿** â†’ **ä½œç‰©æˆç†Ÿ** â†’ **NPCæ´»åŠ¨** â†’ **æ–°çš„ä¸€å¤©**

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **ç®€å•æ˜“æ‡‚**ï¼šçŽ©å®¶å¯ä»¥å¿«é€Ÿç†è§£åŸºæœ¬å¾ªçŽ¯
2. **è‡ªæˆ‘å¼ºåŒ–**ï¼šæ¯ä¸ªè¡ŒåŠ¨éƒ½èƒ½å¸¦æ¥è¿›æ­¥
3. **å¤šè·¯å¾„é€‰æ‹©**ï¼šç§æ¤ã€é‡‡é›†ã€äº¤æ˜“ä¸‰æ¡ä¸»çº¿
4. **æŒç»­æ¿€åŠ±**ï¼šçŸ­æœŸæ”¶èŽ·ä¸Žé•¿æœŸç›®æ ‡ç»“åˆ

è¿™ä¸ªç²¾ç®€ç‰ˆæœ¬çªå‡ºäº†æ¸¸æˆçš„æ ¸å¿ƒå¾ªçŽ¯ï¼ŒåŽ»é™¤äº†å¤æ‚çš„åˆ†æ”¯ï¼Œè®©çŽ©å®¶èƒ½å¤Ÿæ¸…æ™°åœ°çœ‹åˆ°æ¸¸æˆçš„åŸºæœ¬çŽ©æ³•é€»è¾‘ã€‚

# ç²¾ç®€ç‰ˆç³»ç»Ÿæž¶æž„å›¾

## 1. ç²¾ç®€ç³»ç»Ÿæž¶æž„å›¾

```mermaid
graph TB
    subgraph "è¡¨çŽ°å±‚"
        UI[æ¸¸æˆUIç•Œé¢]
        Input[çŽ©å®¶è¾“å…¥]
    end
    
    subgraph "ä¸šåŠ¡é€»è¾‘å±‚"
        Player[è§’è‰²ç³»ç»Ÿ]
        NPC[NPCç³»ç»Ÿ]
        Farm[å†œåœºç³»ç»Ÿ]
        Trade[äº¤æ˜“ç³»ç»Ÿ]
        Time[æ—¶é—´ç³»ç»Ÿ]
    end
    
    subgraph "æ ¸å¿ƒç®—æ³•"
        AStar[A*å¯»è·¯]
        AI[è¡Œä¸ºAI]
        Event[äº‹ä»¶ç³»ç»Ÿ]
    end
    
    subgraph "Unityå¼•æ“Ž"
        Physics[ç‰©ç†å¼•æ“Ž]
        Animation[åŠ¨ç”»ç³»ç»Ÿ]
        Tilemap[åœ°å›¾ç³»ç»Ÿ]
    end
    
    Input --> Player
    UI --> Trade
    UI --> Farm
    
    Player --> Time
    NPC --> AStar
    NPC --> AI
    Farm --> Event
    
    AStar --> Tilemap
    AI --> Animation
    Event --> Physics
    
    style UI fill:#e3f2fd
    style Player fill:#e8f5e8
    style NPC fill:#e8f5e8
    style AStar fill:#fff3e0
    style AI fill:#fff3e0
```

## 2. æ ¸å¿ƒæŠ€æœ¯æ ˆå›¾

```mermaid
graph LR
    subgraph "å¼€å‘çŽ¯å¢ƒ"
        Unity[Unity 2022]
        VS[Visual Studio]
    end
    
    subgraph "æ ¸å¿ƒæŠ€æœ¯"
        Csharp[C# è„šæœ¬]
        Tilemap[Tilemapç³»ç»Ÿ]
        Animator[åŠ¨ç”»æŽ§åˆ¶å™¨]
    end
    
    subgraph "ä¼˜åŒ–æŠ€æœ¯"
        Pool[å¯¹è±¡æ± ]
        Job[Job System]
        SO[ScriptableObject]
    end
    
    Unity --> Csharp
    Unity --> Tilemap
    Unity --> Animator
    
    Csharp --> Pool
    Csharp --> Job
    Csharp --> SO
    
    style Unity fill:#4caf50
    style Csharp fill:#2196f3
    style Pool fill:#ff9800
```

## 3. ç®€åŒ–çš„çŽ©æ³•å¾ªçŽ¯

```mermaid
graph LR
    A[çŽ©å®¶æ“ä½œ] --> B[ç³»ç»Ÿå¤„ç†]
    B --> C[çŠ¶æ€æ›´æ–°]
    C --> D[ç•Œé¢åé¦ˆ]
    D --> A
    
    style A fill:#e3f2fd
    style B fill:#e8f5e8
    style C fill:#fff3e0
    style D fill:#fce4ec
```

## 4. NPCæ ¸å¿ƒçŠ¶æ€

```mermaid
stateDiagram-v2
    [*] --> ç©ºé—²
    ç©ºé—² --> ç§»åŠ¨ : æ”¶åˆ°æŒ‡ä»¤
    ç©ºé—² --> å·¥ä½œ : å·¥ä½œæ—¶é—´
    ç§»åŠ¨ --> ç©ºé—² : åˆ°è¾¾ç›®æ ‡
    å·¥ä½œ --> ç©ºé—² : å®Œæˆä»»åŠ¡
    ç©ºé—² --> å¯¹è¯ : çŽ©å®¶äº¤äº’
    å¯¹è¯ --> ç©ºé—² : ç»“æŸå¯¹è¯
```

## 5. æ€§èƒ½ä¼˜åŒ–è¦ç‚¹

```mermaid
graph TB
    subgraph "ä¼˜åŒ–å‰"
        B1[è®¡ç®—è€—æ—¶: 4.2ms]
        B2[å†…å­˜å ç”¨é«˜]
        B3[å¸§çŽ‡ä¸ç¨³å®š]
    end
    
    subgraph "ä¼˜åŒ–æŠ€æœ¯"
        O1[å¯¹è±¡æ± ]
        O2[è·¯å¾„ç¼“å­˜]
        O3[åˆ†å¸§è®¡ç®—]
    end
    
    subgraph "ä¼˜åŒ–åŽ"
        A1[è®¡ç®—è€—æ—¶: 0.8ms]
        A2[å†…å­˜é™ä½Ž65%]
        A3[ç¨³å®š60FPS]
    end
    
    B1 --> O2 --> A1
    B2 --> O1 --> A2
    B3 --> O3 --> A3
    
    style B1 fill:#ffcdd2
    style B2 fill:#ffcdd2
    style B3 fill:#ffcdd2
    style A1 fill:#c8e6c9
    style A2 fill:#c8e6c9
    style A3 fill:#c8e6c9
``` 